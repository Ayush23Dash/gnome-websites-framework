image: node:15-slim

stages:
  - build:ui
  - build:docs

build:ui:
  stage: build:ui
  script:
    - npm ci
    - npm run build
  artifacts:
    paths:
      - dist
      - assets

pages:
  image: ruby:2.7
  stage: build:docs
  script:
    - mkdir public documentation/_sass/custom
    - cd documentation && gem install bundler
    - bundle install
    - cp ../dist/index.css "_sass/custom/custom.scss"
    - bundle exec jekyll build -d ../public
  artifacts:
    paths:
      - public
  only:
    - main
